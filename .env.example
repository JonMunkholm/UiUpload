# CSV Importer Configuration
# Copy this file to .env and customize as needed
# NEVER commit .env to version control

# =============================================================================
# DATABASE (required)
# =============================================================================

# PostgreSQL connection URL (required - no default)
# Supports both DATABASE_URL and DB_URL for compatibility
DATABASE_URL=postgres://username:password@localhost:5432/database?sslmode=disable

# Connection pool settings
DB_MAX_CONNS=20                    # Maximum connections in pool (default: 20)
DB_MIN_CONNS=4                     # Minimum connections to keep open (default: 4)
DB_MAX_CONN_LIFETIME=1h            # Max lifetime per connection (default: 1h)
DB_MAX_CONN_IDLE_TIME=30m          # Max idle time before closing (default: 30m)

# =============================================================================
# SERVER
# =============================================================================

SERVER_HOST=0.0.0.0                # Interface to bind to (default: 0.0.0.0)
SERVER_PORT=8080                   # Port to listen on (default: 8080)
SERVER_READ_TIMEOUT=15s            # Max duration for reading request (default: 15s)
SERVER_WRITE_TIMEOUT=0s            # Max duration for writing response (default: 0 for SSE)
SERVER_IDLE_TIMEOUT=60s            # Keep-alive timeout (default: 60s)
SERVER_SHUTDOWN_TIMEOUT=30s        # Grace period for shutdown (default: 30s)
SERVER_REQUEST_TIMEOUT=60s         # Middleware request timeout (default: 60s)

# =============================================================================
# UPLOAD PROCESSING
# =============================================================================

UPLOAD_MAX_FILE_SIZE=104857600     # Max file size in bytes (default: 100MB)
UPLOAD_MAX_CONCURRENT=5            # Max parallel uploads (default: 5)
UPLOAD_MAX_WAIT_TIME=30s           # Wait time for upload slot (default: 30s)
UPLOAD_BATCH_SIZE=1000             # Rows per insert batch (default: 1000)
UPLOAD_TIMEOUT=10m                 # Max duration per upload (default: 10m)
UPLOAD_RESET_TIMEOUT=30s           # Max duration for reset operation (default: 30s)

# =============================================================================
# RATE LIMITING
# =============================================================================

RATE_LIMIT_ENABLED=true            # Enable rate limiting (default: true)
RATE_LIMIT_REQUESTS_PER_MINUTE=100 # Requests per minute per IP (default: 100)
RATE_LIMIT_UPLOAD=10               # Upload requests per minute per IP (default: 10)

# =============================================================================
# SECURITY
# =============================================================================

# Comma-separated list of trusted proxy CIDRs
TRUSTED_PROXIES=10.0.0.0/8,172.16.0.0/12,192.168.0.0/16

SECURITY_ENABLE_CSP=true           # Enable Content-Security-Policy (default: true)

# =============================================================================
# LOGGING
# =============================================================================

LOG_LEVEL=info                     # Log level: debug, info, warn, error (default: info)
LOG_FORMAT=text                    # Log format: text or json (default: text)

# =============================================================================
# AUDIT LOG ARCHIVING
# =============================================================================

ARCHIVE_HOT_RETENTION_DAYS=90      # Days to keep in hot table (default: 90)
ARCHIVE_RETENTION_YEARS=7          # Years to keep in archive (default: 7)
ARCHIVE_BATCH_SIZE=5000            # Rows per archive batch (default: 5000)
ARCHIVE_CHECK_INTERVAL=24h         # Archive job interval (default: 24h)
